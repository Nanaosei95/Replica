% Runs pricing algorithm game with 5 firms
function [pstar_sbn,pstar, pi, share,share_sbn,pi_sbn,quant,quant_sbn] = calc_prices(param)

% Params
run('set_parameters.m')


% Contested segments
conF = @(alphai, alphaj, pi, pj) max(min(1/2 + 1/(2*tau)*((alphai - pi) - (alphaj - pj)), 1),0);

% Uncontested segments
unconF = @(alphai, alphaj, pi, pj) max(1/tau*((alphai - pi)),0);

s1 = @(p1,p2,p3,p4,p5) (mu10*unconF(alpha1, alpha0, p1, 0) + mu11*conF(alpha1, alpha1, p1, p1) + mu12*conF(alpha1, alpha1, p1, p2) + mu13*conF(alpha1, alpha1, p1, p3) + mu14*conF(alpha1, alpha1, p1, p4) + mu15*conF(alpha1, alpha1, p1, p5));
s2 = @(p1,p2,p3,p4,p5) (mu20*unconF(alpha1, alpha0, p2, 0) + mu21*conF(alpha1, alpha1, p2, p1) + mu22*conF(alpha1, alpha1, p2, p2) + mu23*conF(alpha1, alpha1, p2, p3) + mu24*conF(alpha1, alpha1, p2, p4) + mu25*conF(alpha1, alpha1, p2, p5));
s3 = @(p1,p2,p3,p4,p5) (mu30*unconF(alpha1, alpha0, p3, 0) + mu31*conF(alpha1, alpha1, p3, p1) + mu32*conF(alpha1, alpha1, p3, p2) + mu33*conF(alpha1, alpha1, p3, p3) + mu34*conF(alpha1, alpha1, p3, p4) + mu35*conF(alpha1, alpha1, p3, p5));
s4 = @(p1,p2,p3,p4,p5) (mu40*unconF(alpha1, alpha0, p4, 0) + mu41*conF(alpha1, alpha1, p4, p1) + mu42*conF(alpha1, alpha1, p4, p2) + mu43*conF(alpha1, alpha1, p4, p3) + mu44*conF(alpha1, alpha1, p4, p4) + mu45*conF(alpha1, alpha1, p4, p5));
s5 = @(p1,p2,p3,p4,p5) (mu50*unconF(alpha1, alpha0, p5, 0) + mu51*conF(alpha1, alpha1, p5, p1) + mu52*conF(alpha1, alpha1, p5, p2) + mu53*conF(alpha1, alpha1, p5, p3) + mu54*conF(alpha1, alpha1, p5, p4) + mu55*conF(alpha1, alpha1, p5, p5));


% Simultaneous bertrand nash game
pstar_sbn = bnfcn(param);


% Pricing algorithm game (firm 1 is leader/has slowest pricing technology)

% Firm 5 response function
par50=(1/2).*(2.*mu50+mu51+mu52+mu53+mu54).^(-1).*(2.*alpha1.*mu50+(-2).* ...
  alpha0.*mu50+c.*(2.*mu50+mu51+mu52+mu53+mu54)+(mu51+mu52+mu53+ ...
  mu54+mu55).*tau);
par51=(1/2).*mu51.*(2.*mu50+mu51+mu52+mu53+mu54).^(-1);
par52=(1/2).*mu52.*(2.*mu50+mu51+mu52+mu53+mu54).^(-1);
par53=(1/2).*mu53.*(2.*mu50+mu51+mu52+mu53+mu54).^(-1);
par54=(1/2).*mu54.*(2.*mu50+mu51+mu52+mu53+mu54).^(-1);

R5 = @(p1,p2,p3,p4) par50 + par51*p1 + par52*p2 + par53*p3 + par54*p4;

% Firm 4 response function
par40=(4.*(2.*mu40+mu41+mu42+mu43+mu45).*(2.*mu50+mu51+mu52+mu53)+2.*( ...
  4.*mu40+2.*(mu41+mu42+mu43)+mu45).*mu54).^(-1).*(c.*(4.*mu40+2.*( ...
  mu41+mu42+mu43)+3.*mu45).*(2.*mu50+mu51+mu52+mu53)+2.*c.*(2.*mu40+ ...
  mu41+mu42+mu43+mu45).*mu54+2.*alpha1.*(mu45.*mu50+2.*mu40.*(2.* ...
  mu50+mu51+mu52+mu53+mu54))+(-2).*alpha0.*(mu45.*mu50+2.*mu40.*(2.* ...
  mu50+mu51+mu52+mu53+mu54))+(4.*mu43.*mu50+4.*mu44.*mu50+4.*mu45.* ...
  mu50+2.*mu43.*mu51+2.*mu44.*mu51+3.*mu45.*mu51+2.*mu43.*mu52+2.* ...
  mu44.*mu52+3.*mu45.*mu52+2.*mu43.*mu53+2.*mu44.*mu53+3.*mu45.* ...
  mu53+2.*mu43.*mu54+2.*mu44.*mu54+3.*mu45.*mu54+2.*mu41.*(2.*mu50+ ...
  mu51+mu52+mu53+mu54)+2.*mu42.*(2.*mu50+mu51+mu52+mu53+mu54)+mu45.* ...
  mu55).*tau);
par41=(4.*mu41.*mu50+2.*mu41.*mu51+mu45.*mu51+2.*mu41.*mu52+2.*mu41.* ...
  mu53+2.*mu41.*mu54).*(4.*(2.*mu40+mu41+mu42+mu43+mu45).*(2.*mu50+ ...
  mu51+mu52+mu53)+2.*(4.*mu40+2.*(mu41+mu42+mu43)+mu45).*mu54).^(-1) ...
  ;
par42=(4.*mu42.*mu50+2.*mu42.*mu51+2.*mu42.*mu52+mu45.*mu52+2.*mu42.* ...
  mu53+2.*mu42.*mu54).*(4.*(2.*mu40+mu41+mu42+mu43+mu45).*(2.*mu50+ ...
  mu51+mu52+mu53)+2.*(4.*mu40+2.*(mu41+mu42+mu43)+mu45).*mu54).^(-1) ...
  ;
par43=(4.*mu43.*mu50+2.*mu43.*mu51+2.*mu43.*mu52+2.*mu43.*mu53+mu45.* ...
  mu53+2.*mu43.*mu54).*(4.*(2.*mu40+mu41+mu42+mu43+mu45).*(2.*mu50+ ...
  mu51+mu52+mu53)+2.*(4.*mu40+2.*(mu41+mu42+mu43)+mu45).*mu54).^(-1) ...
  ;

R4 = @(p1,p2,p3)  par40 + par41*p1 + par42*p2 + par43*p3;


% Firm 3 response function (firm C)
par30=(1/2).*(2.*mu30+mu31+mu32+mu34+(-1).*mu34.*par43+(-1).*mu35.*((-1) ...
  +par53+par43.*par54)).^(-1).*(2.*alpha1.*mu30+(-2).*alpha0.*mu30+ ...
  2.*c.*mu30+c.*mu31+c.*mu32+c.*mu34+c.*mu35+mu34.*par40+(-1).*c.* ...
  mu34.*par43+mu35.*par50+(-1).*c.*mu35.*par53+mu35.*par40.*par54+( ...
  -1).*c.*mu35.*par43.*par54+(mu31+mu32+mu33+mu34+mu35).*tau);
par31=(1/2).*(mu31+mu34.*par41+mu35.*par51+mu35.*par41.*par54).*(2.* ...
  mu30+mu31+mu32+mu34+mu35+(-1).*mu34.*par43+(-1).*mu35.*par53+(-1) ...
  .*mu35.*par43.*par54).^(-1);
par32=(1/2).*(mu32+mu34.*par42+mu35.*par52+mu35.*par42.*par54).*(2.* ...
  mu30+mu31+mu32+mu34+mu35+(-1).*mu34.*par43+(-1).*mu35.*par53+(-1) ...
  .*mu35.*par43.*par54).^(-1);

R3 = @(p1,p2)  par30 + par31*p1 + par32*p2; 


% Firm 2 response function (firm D)
pstar(2) = ((-16).*mu10.*mu20+(-8).*mu12.*mu20+(-8).*mu13.*mu20+(-8).*mu14.* ...
  mu20+(-8).*mu15.*mu20+(-8).*mu10.*mu21+(-3).*mu12.*mu21+(-4).* ...
  mu13.*mu21+(-4).*mu14.*mu21+(-4).*mu15.*mu21+(-8).*mu10.*mu23+(-4) ...
  .*mu12.*mu23+(-4).*mu13.*mu23+(-4).*mu14.*mu23+(-4).*mu15.*mu23+( ...
  -8).*mu10.*mu24+(-4).*mu12.*mu24+(-4).*mu13.*mu24+(-4).*mu14.* ...
  mu24+(-4).*mu15.*mu24+(-8).*mu10.*mu25+(-4).*mu12.*mu25+(-4).* ...
  mu13.*mu25+(-4).*mu14.*mu25+(-4).*mu15.*mu25+8.*mu13.*mu20.*par31+ ...
  4.*mu13.*mu21.*par31+mu12.*mu23.*par31+4.*mu13.*mu23.*par31+4.* ...
  mu13.*mu24.*par31+4.*mu13.*mu25.*par31+mu13.*mu21.*par32+8.*mu10.* ...
  mu23.*par32+4.*mu12.*mu23.*par32+4.*mu13.*mu23.*par32+4.*mu14.* ...
  mu23.*par32+4.*mu15.*mu23.*par32+(-3).*mu13.*mu23.*par31.*par32+ ...
  8.*mu14.*mu20.*par41+4.*mu14.*mu21.*par41+4.*mu14.*mu23.*par41+ ...
  mu12.*mu24.*par41+4.*mu14.*mu24.*par41+4.*mu14.*mu25.*par41+(-4).* ...
  mu14.*mu23.*par32.*par41+mu13.*mu24.*par32.*par41+mu14.*mu21.* ...
  par42+8.*mu10.*mu24.*par42+4.*mu12.*mu24.*par42+4.*mu13.*mu24.* ...
  par42+4.*mu14.*mu24.*par42+4.*mu15.*mu24.*par42+mu14.*mu23.* ...
  par31.*par42+(-4).*mu13.*mu24.*par31.*par42+(-3).*mu14.*mu24.* ...
  par41.*par42+8.*mu14.*mu20.*par31.*par43+4.*mu14.*mu21.*par31.* ...
  par43+4.*mu14.*mu23.*par31.*par43+mu12.*mu24.*par31.*par43+4.* ...
  mu14.*mu24.*par31.*par43+4.*mu14.*mu25.*par31.*par43+mu14.*mu21.* ...
  par32.*par43+8.*mu10.*mu24.*par32.*par43+4.*mu12.*mu24.*par32.* ...
  par43+4.*mu13.*mu24.*par32.*par43+4.*mu14.*mu24.*par32.*par43+4.* ...
  mu15.*mu24.*par32.*par43+(-3).*mu14.*mu23.*par31.*par32.*par43+( ...
  -3).*mu13.*mu24.*par31.*par32.*par43+(-3).*mu14.*mu24.*par32.* ...
  par41.*par43+(-3).*mu14.*mu24.*par31.*par42.*par43+(-3).*mu14.* ...
  mu24.*par31.*par32.*par43.^2+8.*mu15.*mu20.*par51+4.*mu15.*mu21.* ...
  par51+4.*mu15.*mu23.*par51+4.*mu15.*mu24.*par51+mu12.*mu25.*par51+ ...
  4.*mu15.*mu25.*par51+(-4).*mu15.*mu23.*par32.*par51+mu13.*mu25.* ...
  par32.*par51+(-4).*mu15.*mu24.*par42.*par51+mu14.*mu25.*par42.* ...
  par51+(-4).*mu15.*mu24.*par32.*par43.*par51+mu14.*mu25.*par32.* ...
  par43.*par51+mu15.*mu21.*par52+8.*mu10.*mu25.*par52+4.*mu12.* ...
  mu25.*par52+4.*mu13.*mu25.*par52+4.*mu14.*mu25.*par52+4.*mu15.* ...
  mu25.*par52+mu15.*mu23.*par31.*par52+(-4).*mu13.*mu25.*par31.* ...
  par52+mu15.*mu24.*par41.*par52+(-4).*mu14.*mu25.*par41.*par52+ ...
  mu15.*mu24.*par31.*par43.*par52+(-4).*mu14.*mu25.*par31.*par43.* ...
  par52+(-3).*mu15.*mu25.*par51.*par52+8.*mu15.*mu20.*par31.*par53+ ...
  4.*mu15.*mu21.*par31.*par53+4.*mu15.*mu23.*par31.*par53+4.*mu15.* ...
  mu24.*par31.*par53+mu12.*mu25.*par31.*par53+4.*mu15.*mu25.*par31.* ...
  par53+mu15.*mu21.*par32.*par53+8.*mu10.*mu25.*par32.*par53+4.* ...
  mu12.*mu25.*par32.*par53+4.*mu13.*mu25.*par32.*par53+4.*mu14.* ...
  mu25.*par32.*par53+4.*mu15.*mu25.*par32.*par53+(-3).*mu15.*mu23.* ...
  par31.*par32.*par53+(-3).*mu13.*mu25.*par31.*par32.*par53+mu15.* ...
  mu24.*par32.*par41.*par53+(-4).*mu14.*mu25.*par32.*par41.*par53+( ...
  -4).*mu15.*mu24.*par31.*par42.*par53+mu14.*mu25.*par31.*par42.* ...
  par53+(-3).*mu15.*mu24.*par31.*par32.*par43.*par53+(-3).*mu14.* ...
  mu25.*par31.*par32.*par43.*par53+(-3).*mu15.*mu25.*par32.*par51.* ...
  par53+(-3).*mu15.*mu25.*par31.*par52.*par53+(-3).*mu15.*mu25.* ...
  par31.*par32.*par53.^2+mu25.*(mu12.*(par41+4.*par42+par31.*par43+ ...
  4.*par32.*par43)+(par42+par32.*par43).*(8.*mu10+mu14.*(4+(-3).* ...
  par41+(-3).*par31.*par43))+mu13.*((-4).*((-1)+par31).*par42+ ...
  par32.*(par41+4.*par43+(-3).*par31.*par43))).*par54+mu15.*(4.* ...
  mu23.*par41+4.*mu24.*par41+4.*mu25.*par41+(-4).*mu23.*par32.* ...
  par41+4.*mu25.*par42+mu23.*par31.*par42+(-3).*mu24.*par41.*par42+ ...
  4.*mu23.*par31.*par43+4.*mu24.*par31.*par43+4.*mu25.*par31.*par43+ ...
  4.*mu25.*par32.*par43+(-3).*mu23.*par31.*par32.*par43+(-3).*mu24.* ...
  par32.*par41.*par43+(-3).*mu24.*par31.*par42.*par43+(-3).*mu24.* ...
  par31.*par32.*par43.^2+8.*mu20.*(par41+par31.*par43)+mu21.*(4.* ...
  par41+par42+4.*par31.*par43+par32.*par43)+(-3).*mu25.*par42.* ...
  par51+(-3).*mu25.*par32.*par43.*par51+(-3).*mu25.*par41.*par52+( ...
  -3).*mu25.*par31.*par43.*par52+(-3).*mu25.*(par32.*par41+par31.* ...
  par42+2.*par31.*par32.*par43).*par53).*par54+(-3).*mu15.*mu25.*( ...
  par41+par31.*par43).*(par42+par32.*par43).*par54.^2).^(-1).*((-8) ...
  .*c.*mu10.*mu20+(-4).*c.*mu12.*mu20+(-4).*c.*mu13.*mu20+(-4).*c.* ...
  mu14.*mu20+(-4).*c.*mu15.*mu20+(-6).*c.*mu10.*mu21+(-3).*c.*mu12.* ...
  mu21+(-3).*c.*mu13.*mu21+(-3).*c.*mu14.*mu21+(-3).*c.*mu15.*mu21+( ...
  -4).*c.*mu10.*mu23+(-2).*c.*mu12.*mu23+(-2).*c.*mu13.*mu23+(-2).* ...
  c.*mu14.*mu23+(-2).*c.*mu15.*mu23+(-4).*c.*mu10.*mu24+(-2).*c.* ...
  mu12.*mu24+(-2).*c.*mu13.*mu24+(-2).*c.*mu14.*mu24+(-2).*c.*mu15.* ...
  mu24+(-4).*c.*mu10.*mu25+(-2).*c.*mu12.*mu25+(-2).*c.*mu13.*mu25+( ...
  -2).*c.*mu14.*mu25+(-2).*c.*mu15.*mu25+(-1).*mu13.*mu21.*par30+( ...
  -4).*mu10.*mu23.*par30+(-2).*mu12.*mu23.*par30+(-2).*mu13.*mu23.* ...
  par30+(-2).*mu14.*mu23.*par30+(-2).*mu15.*mu23.*par30+4.*c.*mu13.* ...
  mu20.*par31+3.*c.*mu13.*mu21.*par31+(-2).*c.*mu10.*mu23.*par31+( ...
  -1).*c.*mu12.*mu23.*par31+c.*mu13.*mu23.*par31+(-1).*c.*mu14.* ...
  mu23.*par31+(-1).*c.*mu15.*mu23.*par31+2.*c.*mu13.*mu24.*par31+2.* ...
  c.*mu13.*mu25.*par31+mu13.*mu23.*par30.*par31+c.*mu13.*mu23.* ...
  par31.^2+4.*c.*mu10.*mu23.*par32+2.*c.*mu12.*mu23.*par32+2.*c.* ...
  mu13.*mu23.*par32+2.*c.*mu14.*mu23.*par32+2.*c.*mu15.*mu23.*par32+ ...
  (-2).*c.*mu13.*mu23.*par31.*par32+(-1).*mu14.*mu21.*par40+(-4).* ...
  mu10.*mu24.*par40+(-2).*mu12.*mu24.*par40+(-2).*mu13.*mu24.*par40+ ...
  (-2).*mu14.*mu24.*par40+(-2).*mu15.*mu24.*par40+(-1).*mu14.*mu23.* ...
  par31.*par40+2.*mu13.*mu24.*par31.*par40+4.*c.*mu14.*mu20.*par41+ ...
  3.*c.*mu14.*mu21.*par41+2.*c.*mu14.*mu23.*par41+(-2).*c.*mu10.* ...
  mu24.*par41+(-1).*c.*mu12.*mu24.*par41+(-1).*c.*mu13.*mu24.*par41+ ...
  c.*mu14.*mu24.*par41+(-1).*c.*mu15.*mu24.*par41+2.*c.*mu14.*mu25.* ...
  par41+2.*mu14.*mu23.*par30.*par41+(-1).*mu13.*mu24.*par30.*par41+ ...
  c.*mu14.*mu23.*par31.*par41+c.*mu13.*mu24.*par31.*par41+(-2).*c.* ...
  mu14.*mu23.*par32.*par41+mu14.*mu24.*par40.*par41+c.*mu14.*mu24.* ...
  par41.^2+4.*c.*mu10.*mu24.*par42+2.*c.*mu12.*mu24.*par42+2.*c.* ...
  mu13.*mu24.*par42+2.*c.*mu14.*mu24.*par42+2.*c.*mu15.*mu24.*par42+ ...
  (-2).*c.*mu13.*mu24.*par31.*par42+(-2).*c.*mu14.*mu24.*par41.* ...
  par42+(-1).*mu14.*mu21.*par30.*par43+(-4).*mu10.*mu24.*par30.* ...
  par43+(-2).*mu12.*mu24.*par30.*par43+(-2).*mu13.*mu24.*par30.* ...
  par43+(-2).*mu14.*mu24.*par30.*par43+(-2).*mu15.*mu24.*par30.* ...
  par43+4.*c.*mu14.*mu20.*par31.*par43+3.*c.*mu14.*mu21.*par31.* ...
  par43+2.*c.*mu14.*mu23.*par31.*par43+(-2).*c.*mu10.*mu24.*par31.* ...
  par43+(-1).*c.*mu12.*mu24.*par31.*par43+(-1).*c.*mu13.*mu24.* ...
  par31.*par43+c.*mu14.*mu24.*par31.*par43+(-1).*c.*mu15.*mu24.* ...
  par31.*par43+2.*c.*mu14.*mu25.*par31.*par43+mu14.*mu23.*par30.* ...
  par31.*par43+mu13.*mu24.*par30.*par31.*par43+c.*mu14.*mu23.* ...
  par31.^2.*par43+c.*mu13.*mu24.*par31.^2.*par43+4.*c.*mu10.*mu24.* ...
  par32.*par43+2.*c.*mu12.*mu24.*par32.*par43+2.*c.*mu13.*mu24.* ...
  par32.*par43+2.*c.*mu14.*mu24.*par32.*par43+2.*c.*mu15.*mu24.* ...
  par32.*par43+(-2).*c.*mu14.*mu23.*par31.*par32.*par43+(-2).*c.* ...
  mu13.*mu24.*par31.*par32.*par43+mu14.*mu24.*par31.*par40.*par43+ ...
  mu14.*mu24.*par30.*par41.*par43+2.*c.*mu14.*mu24.*par31.*par41.* ...
  par43+(-2).*c.*mu14.*mu24.*par32.*par41.*par43+(-2).*c.*mu14.* ...
  mu24.*par31.*par42.*par43+mu14.*mu24.*par30.*par31.*par43.^2+c.* ...
  mu14.*mu24.*par31.^2.*par43.^2+(-2).*c.*mu14.*mu24.*par31.*par32.* ...
  par43.^2+(-1).*mu15.*mu21.*par50+(-4).*mu10.*mu25.*par50+(-2).* ...
  mu12.*mu25.*par50+(-2).*mu13.*mu25.*par50+(-2).*mu14.*mu25.*par50+ ...
  (-2).*mu15.*mu25.*par50+(-1).*mu15.*mu23.*par31.*par50+2.*mu13.* ...
  mu25.*par31.*par50+(-1).*mu15.*mu24.*par41.*par50+2.*mu14.*mu25.* ...
  par41.*par50+(-1).*mu15.*mu24.*par31.*par43.*par50+2.*mu14.*mu25.* ...
  par31.*par43.*par50+4.*c.*mu15.*mu20.*par51+3.*c.*mu15.*mu21.* ...
  par51+2.*c.*mu15.*mu23.*par51+2.*c.*mu15.*mu24.*par51+(-2).*c.* ...
  mu10.*mu25.*par51+(-1).*c.*mu12.*mu25.*par51+(-1).*c.*mu13.*mu25.* ...
  par51+(-1).*c.*mu14.*mu25.*par51+c.*mu15.*mu25.*par51+2.*mu15.* ...
  mu23.*par30.*par51+(-1).*mu13.*mu25.*par30.*par51+c.*mu15.*mu23.* ...
  par31.*par51+c.*mu13.*mu25.*par31.*par51+(-2).*c.*mu15.*mu23.* ...
  par32.*par51+2.*mu15.*mu24.*par40.*par51+(-1).*mu14.*mu25.*par40.* ...
  par51+c.*mu15.*mu24.*par41.*par51+c.*mu14.*mu25.*par41.*par51+(-2) ...
  .*c.*mu15.*mu24.*par42.*par51+2.*mu15.*mu24.*par30.*par43.*par51+( ...
  -1).*mu14.*mu25.*par30.*par43.*par51+c.*mu15.*mu24.*par31.*par43.* ...
  par51+c.*mu14.*mu25.*par31.*par43.*par51+(-2).*c.*mu15.*mu24.* ...
  par32.*par43.*par51+mu15.*mu25.*par50.*par51+c.*mu15.*mu25.* ...
  par51.^2+4.*c.*mu10.*mu25.*par52+2.*c.*mu12.*mu25.*par52+2.*c.* ...
  mu13.*mu25.*par52+2.*c.*mu14.*mu25.*par52+2.*c.*mu15.*mu25.*par52+ ...
  (-2).*c.*mu13.*mu25.*par31.*par52+(-2).*c.*mu14.*mu25.*par41.* ...
  par52+(-2).*c.*mu14.*mu25.*par31.*par43.*par52+(-2).*c.*mu15.* ...
  mu25.*par51.*par52+(-1).*mu15.*mu21.*par30.*par53+(-4).*mu10.* ...
  mu25.*par30.*par53+(-2).*mu12.*mu25.*par30.*par53+(-2).*mu13.* ...
  mu25.*par30.*par53+(-2).*mu14.*mu25.*par30.*par53+(-2).*mu15.* ...
  mu25.*par30.*par53+4.*c.*mu15.*mu20.*par31.*par53+3.*c.*mu15.* ...
  mu21.*par31.*par53+2.*c.*mu15.*mu23.*par31.*par53+2.*c.*mu15.* ...
  mu24.*par31.*par53+(-2).*c.*mu10.*mu25.*par31.*par53+(-1).*c.* ...
  mu12.*mu25.*par31.*par53+(-1).*c.*mu13.*mu25.*par31.*par53+(-1).* ...
  c.*mu14.*mu25.*par31.*par53+c.*mu15.*mu25.*par31.*par53+mu15.* ...
  mu23.*par30.*par31.*par53+mu13.*mu25.*par30.*par31.*par53+c.* ...
  mu15.*mu23.*par31.^2.*par53+c.*mu13.*mu25.*par31.^2.*par53+4.*c.* ...
  mu10.*mu25.*par32.*par53+2.*c.*mu12.*mu25.*par32.*par53+2.*c.* ...
  mu13.*mu25.*par32.*par53+2.*c.*mu14.*mu25.*par32.*par53+2.*c.* ...
  mu15.*mu25.*par32.*par53+(-2).*c.*mu15.*mu23.*par31.*par32.*par53+ ...
  (-2).*c.*mu13.*mu25.*par31.*par32.*par53+2.*mu15.*mu24.*par31.* ...
  par40.*par53+(-1).*mu14.*mu25.*par31.*par40.*par53+(-1).*mu15.* ...
  mu24.*par30.*par41.*par53+2.*mu14.*mu25.*par30.*par41.*par53+c.* ...
  mu15.*mu24.*par31.*par41.*par53+c.*mu14.*mu25.*par31.*par41.* ...
  par53+(-2).*c.*mu14.*mu25.*par32.*par41.*par53+(-2).*c.*mu15.* ...
  mu24.*par31.*par42.*par53+mu15.*mu24.*par30.*par31.*par43.*par53+ ...
  mu14.*mu25.*par30.*par31.*par43.*par53+c.*mu15.*mu24.*par31.^2.* ...
  par43.*par53+c.*mu14.*mu25.*par31.^2.*par43.*par53+(-2).*c.*mu15.* ...
  mu24.*par31.*par32.*par43.*par53+(-2).*c.*mu14.*mu25.*par31.* ...
  par32.*par43.*par53+mu15.*mu25.*par31.*par50.*par53+mu15.*mu25.* ...
  par30.*par51.*par53+2.*c.*mu15.*mu25.*par31.*par51.*par53+(-2).* ...
  c.*mu15.*mu25.*par32.*par51.*par53+(-2).*c.*mu15.*mu25.*par31.* ...
  par52.*par53+mu15.*mu25.*par30.*par31.*par53.^2+c.*mu15.*mu25.* ...
  par31.^2.*par53.^2+(-2).*c.*mu15.*mu25.*par31.*par32.*par53.^2+( ...
  -1).*mu15.*mu21.*par40.*par54+(-4).*mu10.*mu25.*par40.*par54+(-2) ...
  .*mu12.*mu25.*par40.*par54+(-2).*mu13.*mu25.*par40.*par54+(-2).* ...
  mu14.*mu25.*par40.*par54+(-2).*mu15.*mu25.*par40.*par54+(-1).* ...
  mu15.*mu23.*par31.*par40.*par54+2.*mu13.*mu25.*par31.*par40.* ...
  par54+4.*c.*mu15.*mu20.*par41.*par54+3.*c.*mu15.*mu21.*par41.* ...
  par54+2.*c.*mu15.*mu23.*par41.*par54+2.*c.*mu15.*mu24.*par41.* ...
  par54+(-2).*c.*mu10.*mu25.*par41.*par54+(-1).*c.*mu12.*mu25.* ...
  par41.*par54+(-1).*c.*mu13.*mu25.*par41.*par54+(-1).*c.*mu14.* ...
  mu25.*par41.*par54+c.*mu15.*mu25.*par41.*par54+2.*mu15.*mu23.* ...
  par30.*par41.*par54+(-1).*mu13.*mu25.*par30.*par41.*par54+c.* ...
  mu15.*mu23.*par31.*par41.*par54+c.*mu13.*mu25.*par31.*par41.* ...
  par54+(-2).*c.*mu15.*mu23.*par32.*par41.*par54+mu15.*mu24.*par40.* ...
  par41.*par54+mu14.*mu25.*par40.*par41.*par54+c.*mu15.*mu24.* ...
  par41.^2.*par54+c.*mu14.*mu25.*par41.^2.*par54+4.*c.*mu10.*mu25.* ...
  par42.*par54+2.*c.*mu12.*mu25.*par42.*par54+2.*c.*mu13.*mu25.* ...
  par42.*par54+2.*c.*mu14.*mu25.*par42.*par54+2.*c.*mu15.*mu25.* ...
  par42.*par54+(-2).*c.*mu13.*mu25.*par31.*par42.*par54+(-2).*c.* ...
  mu15.*mu24.*par41.*par42.*par54+(-2).*c.*mu14.*mu25.*par41.* ...
  par42.*par54+(-1).*mu15.*mu21.*par30.*par43.*par54+(-4).*mu10.* ...
  mu25.*par30.*par43.*par54+(-2).*mu12.*mu25.*par30.*par43.*par54+( ...
  -2).*mu13.*mu25.*par30.*par43.*par54+(-2).*mu14.*mu25.*par30.* ...
  par43.*par54+(-2).*mu15.*mu25.*par30.*par43.*par54+4.*c.*mu15.* ...
  mu20.*par31.*par43.*par54+3.*c.*mu15.*mu21.*par31.*par43.*par54+ ...
  2.*c.*mu15.*mu23.*par31.*par43.*par54+2.*c.*mu15.*mu24.*par31.* ...
  par43.*par54+(-2).*c.*mu10.*mu25.*par31.*par43.*par54+(-1).*c.* ...
  mu12.*mu25.*par31.*par43.*par54+(-1).*c.*mu13.*mu25.*par31.* ...
  par43.*par54+(-1).*c.*mu14.*mu25.*par31.*par43.*par54+c.*mu15.* ...
  mu25.*par31.*par43.*par54+mu15.*mu23.*par30.*par31.*par43.*par54+ ...
  mu13.*mu25.*par30.*par31.*par43.*par54+c.*mu15.*mu23.*par31.^2.* ...
  par43.*par54+c.*mu13.*mu25.*par31.^2.*par43.*par54+4.*c.*mu10.* ...
  mu25.*par32.*par43.*par54+2.*c.*mu12.*mu25.*par32.*par43.*par54+ ...
  2.*c.*mu13.*mu25.*par32.*par43.*par54+2.*c.*mu14.*mu25.*par32.* ...
  par43.*par54+2.*c.*mu15.*mu25.*par32.*par43.*par54+(-2).*c.*mu15.* ...
  mu23.*par31.*par32.*par43.*par54+(-2).*c.*mu13.*mu25.*par31.* ...
  par32.*par43.*par54+mu15.*mu24.*par31.*par40.*par43.*par54+mu14.* ...
  mu25.*par31.*par40.*par43.*par54+mu15.*mu24.*par30.*par41.*par43.* ...
  par54+mu14.*mu25.*par30.*par41.*par43.*par54+2.*c.*mu15.*mu24.* ...
  par31.*par41.*par43.*par54+2.*c.*mu14.*mu25.*par31.*par41.*par43.* ...
  par54+(-2).*c.*mu15.*mu24.*par32.*par41.*par43.*par54+(-2).*c.* ...
  mu14.*mu25.*par32.*par41.*par43.*par54+(-2).*c.*mu15.*mu24.* ...
  par31.*par42.*par43.*par54+(-2).*c.*mu14.*mu25.*par31.*par42.* ...
  par43.*par54+mu15.*mu24.*par30.*par31.*par43.^2.*par54+mu14.* ...
  mu25.*par30.*par31.*par43.^2.*par54+c.*mu15.*mu24.*par31.^2.* ...
  par43.^2.*par54+c.*mu14.*mu25.*par31.^2.*par43.^2.*par54+(-2).*c.* ...
  mu15.*mu24.*par31.*par32.*par43.^2.*par54+(-2).*c.*mu14.*mu25.* ...
  par31.*par32.*par43.^2.*par54+mu15.*mu25.*par41.*par50.*par54+ ...
  mu15.*mu25.*par31.*par43.*par50.*par54+mu15.*mu25.*par40.*par51.* ...
  par54+2.*c.*mu15.*mu25.*par41.*par51.*par54+(-2).*c.*mu15.*mu25.* ...
  par42.*par51.*par54+mu15.*mu25.*par30.*par43.*par51.*par54+2.*c.* ...
  mu15.*mu25.*par31.*par43.*par51.*par54+(-2).*c.*mu15.*mu25.* ...
  par32.*par43.*par51.*par54+(-2).*c.*mu15.*mu25.*par41.*par52.* ...
  par54+(-2).*c.*mu15.*mu25.*par31.*par43.*par52.*par54+mu15.*mu25.* ...
  par31.*par40.*par53.*par54+mu15.*mu25.*par30.*par41.*par53.*par54+ ...
  2.*c.*mu15.*mu25.*par31.*par41.*par53.*par54+(-2).*c.*mu15.*mu25.* ...
  par32.*par41.*par53.*par54+(-2).*c.*mu15.*mu25.*par31.*par42.* ...
  par53.*par54+2.*mu15.*mu25.*par30.*par31.*par43.*par53.*par54+2.* ...
  c.*mu15.*mu25.*par31.^2.*par43.*par53.*par54+(-4).*c.*mu15.*mu25.* ...
  par31.*par32.*par43.*par53.*par54+mu15.*mu25.*par40.*par41.* ...
  par54.^2+c.*mu15.*mu25.*par41.^2.*par54.^2+(-2).*c.*mu15.*mu25.* ...
  par41.*par42.*par54.^2+mu15.*mu25.*par31.*par40.*par43.*par54.^2+ ...
  mu15.*mu25.*par30.*par41.*par43.*par54.^2+2.*c.*mu15.*mu25.* ...
  par31.*par41.*par43.*par54.^2+(-2).*c.*mu15.*mu25.*par32.*par41.* ...
  par43.*par54.^2+(-2).*c.*mu15.*mu25.*par31.*par42.*par43.* ...
  par54.^2+mu15.*mu25.*par30.*par31.*par43.^2.*par54.^2+c.*mu15.* ...
  mu25.*par31.^2.*par43.^2.*par54.^2+(-2).*c.*mu15.*mu25.*par31.* ...
  par32.*par43.^2.*par54.^2+(-2).*alpha1.*mu10.*(4.*mu20+mu21+mu24.* ...
  par41+mu25.*par51+par31.*(mu23+mu24.*par43+mu25.*par53)+mu25.*( ...
  par41+par31.*par43).*par54)+4.*alpha1.*mu20.*((-1).*mu12+mu13.*(( ...
  -1)+par31)+mu14.*((-1)+par41+par31.*par43)+mu15.*((-1)+par51+ ...
  par41.*par54+par31.*(par53+par43.*par54)))+2.*alpha0.*(mu10.*(4.* ...
  mu20+mu21+mu24.*par41+mu25.*par51+par31.*(mu23+mu24.*par43+mu25.* ...
  par53)+mu25.*(par41+par31.*par43).*par54)+2.*mu20.*(mu12+mu13+(-1) ...
  .*mu13.*par31+(-1).*mu14.*((-1)+par41+par31.*par43)+(-1).*mu15.*(( ...
  -1)+par51+par41.*par54+par31.*(par53+par43.*par54))))+(-1).*( ...
  mu11.*mu21+3.*mu12.*mu21+3.*mu13.*mu21+3.*mu14.*mu21+3.*mu15.* ...
  mu21+2.*mu12.*mu22+2.*mu13.*mu22+2.*mu14.*mu22+2.*mu15.*mu22+2.* ...
  mu12.*mu23+2.*mu13.*mu23+2.*mu14.*mu23+2.*mu15.*mu23+2.*mu12.* ...
  mu24+2.*mu13.*mu24+2.*mu14.*mu24+2.*mu15.*mu24+2.*mu12.*mu25+2.* ...
  mu13.*mu25+2.*mu14.*mu25+2.*mu15.*mu25+4.*mu10.*(mu21+mu22+mu23+ ...
  mu24+mu25)+(-2).*mu13.*mu21.*par31+(-2).*mu13.*mu22.*par31+mu11.* ...
  mu23.*par31+mu12.*mu23.*par31+(-1).*mu13.*mu23.*par31+mu14.*mu23.* ...
  par31+mu15.*mu23.*par31+(-2).*mu13.*mu24.*par31+(-2).*mu13.*mu25.* ...
  par31+(-2).*mu14.*mu21.*par41+(-2).*mu14.*mu22.*par41+(-2).*mu14.* ...
  mu23.*par41+mu11.*mu24.*par41+mu12.*mu24.*par41+mu13.*mu24.*par41+ ...
  (-1).*mu14.*mu24.*par41+mu15.*mu24.*par41+(-2).*mu14.*mu25.*par41+ ...
  (-2).*mu14.*mu21.*par31.*par43+(-2).*mu14.*mu22.*par31.*par43+(-2) ...
  .*mu14.*mu23.*par31.*par43+mu11.*mu24.*par31.*par43+mu12.*mu24.* ...
  par31.*par43+mu13.*mu24.*par31.*par43+(-1).*mu14.*mu24.*par31.* ...
  par43+mu15.*mu24.*par31.*par43+(-2).*mu14.*mu25.*par31.*par43+(-2) ...
  .*mu15.*mu21.*par51+(-2).*mu15.*mu22.*par51+(-2).*mu15.*mu23.* ...
  par51+(-2).*mu15.*mu24.*par51+mu11.*mu25.*par51+mu12.*mu25.*par51+ ...
  mu13.*mu25.*par51+mu14.*mu25.*par51+(-1).*mu15.*mu25.*par51+(-2).* ...
  mu15.*mu21.*par31.*par53+(-2).*mu15.*mu22.*par31.*par53+(-2).* ...
  mu15.*mu23.*par31.*par53+(-2).*mu15.*mu24.*par31.*par53+mu11.* ...
  mu25.*par31.*par53+mu12.*mu25.*par31.*par53+mu13.*mu25.*par31.* ...
  par53+mu14.*mu25.*par31.*par53+(-1).*mu15.*mu25.*par31.*par53+(-1) ...
  .*((-1).*(mu11+mu12+mu13+mu14).*mu25+mu15.*(2.*(mu21+mu22+mu23+ ...
  mu24)+mu25)).*(par41+par31.*par43).*par54).*tau);


% Firm 1 response function (firm E)
pstar(1) = ((-16).*mu10.*mu20+(-8).*mu12.*mu20+(-8).*mu13.*mu20+(-8).*mu14.* ...
  mu20+(-8).*mu15.*mu20+(-8).*mu10.*mu21+(-3).*mu12.*mu21+(-4).* ...
  mu13.*mu21+(-4).*mu14.*mu21+(-4).*mu15.*mu21+(-8).*mu10.*mu23+(-4) ...
  .*mu12.*mu23+(-4).*mu13.*mu23+(-4).*mu14.*mu23+(-4).*mu15.*mu23+( ...
  -8).*mu10.*mu24+(-4).*mu12.*mu24+(-4).*mu13.*mu24+(-4).*mu14.* ...
  mu24+(-4).*mu15.*mu24+(-8).*mu10.*mu25+(-4).*mu12.*mu25+(-4).* ...
  mu13.*mu25+(-4).*mu14.*mu25+(-4).*mu15.*mu25+8.*mu13.*mu20.*par31+ ...
  4.*mu13.*mu21.*par31+mu12.*mu23.*par31+4.*mu13.*mu23.*par31+4.* ...
  mu13.*mu24.*par31+4.*mu13.*mu25.*par31+mu13.*mu21.*par32+8.*mu10.* ...
  mu23.*par32+4.*mu12.*mu23.*par32+4.*mu13.*mu23.*par32+4.*mu14.* ...
  mu23.*par32+4.*mu15.*mu23.*par32+(-3).*mu13.*mu23.*par31.*par32+ ...
  8.*mu14.*mu20.*par41+4.*mu14.*mu21.*par41+4.*mu14.*mu23.*par41+ ...
  mu12.*mu24.*par41+4.*mu14.*mu24.*par41+4.*mu14.*mu25.*par41+(-4).* ...
  mu14.*mu23.*par32.*par41+mu13.*mu24.*par32.*par41+mu14.*mu21.* ...
  par42+8.*mu10.*mu24.*par42+4.*mu12.*mu24.*par42+4.*mu13.*mu24.* ...
  par42+4.*mu14.*mu24.*par42+4.*mu15.*mu24.*par42+mu14.*mu23.* ...
  par31.*par42+(-4).*mu13.*mu24.*par31.*par42+(-3).*mu14.*mu24.* ...
  par41.*par42+8.*mu14.*mu20.*par31.*par43+4.*mu14.*mu21.*par31.* ...
  par43+4.*mu14.*mu23.*par31.*par43+mu12.*mu24.*par31.*par43+4.* ...
  mu14.*mu24.*par31.*par43+4.*mu14.*mu25.*par31.*par43+mu14.*mu21.* ...
  par32.*par43+8.*mu10.*mu24.*par32.*par43+4.*mu12.*mu24.*par32.* ...
  par43+4.*mu13.*mu24.*par32.*par43+4.*mu14.*mu24.*par32.*par43+4.* ...
  mu15.*mu24.*par32.*par43+(-3).*mu14.*mu23.*par31.*par32.*par43+( ...
  -3).*mu13.*mu24.*par31.*par32.*par43+(-3).*mu14.*mu24.*par32.* ...
  par41.*par43+(-3).*mu14.*mu24.*par31.*par42.*par43+(-3).*mu14.* ...
  mu24.*par31.*par32.*par43.^2+8.*mu15.*mu20.*par51+4.*mu15.*mu21.* ...
  par51+4.*mu15.*mu23.*par51+4.*mu15.*mu24.*par51+mu12.*mu25.*par51+ ...
  4.*mu15.*mu25.*par51+(-4).*mu15.*mu23.*par32.*par51+mu13.*mu25.* ...
  par32.*par51+(-4).*mu15.*mu24.*par42.*par51+mu14.*mu25.*par42.* ...
  par51+(-4).*mu15.*mu24.*par32.*par43.*par51+mu14.*mu25.*par32.* ...
  par43.*par51+mu15.*mu21.*par52+8.*mu10.*mu25.*par52+4.*mu12.* ...
  mu25.*par52+4.*mu13.*mu25.*par52+4.*mu14.*mu25.*par52+4.*mu15.* ...
  mu25.*par52+mu15.*mu23.*par31.*par52+(-4).*mu13.*mu25.*par31.* ...
  par52+mu15.*mu24.*par41.*par52+(-4).*mu14.*mu25.*par41.*par52+ ...
  mu15.*mu24.*par31.*par43.*par52+(-4).*mu14.*mu25.*par31.*par43.* ...
  par52+(-3).*mu15.*mu25.*par51.*par52+8.*mu15.*mu20.*par31.*par53+ ...
  4.*mu15.*mu21.*par31.*par53+4.*mu15.*mu23.*par31.*par53+4.*mu15.* ...
  mu24.*par31.*par53+mu12.*mu25.*par31.*par53+4.*mu15.*mu25.*par31.* ...
  par53+mu15.*mu21.*par32.*par53+8.*mu10.*mu25.*par32.*par53+4.* ...
  mu12.*mu25.*par32.*par53+4.*mu13.*mu25.*par32.*par53+4.*mu14.* ...
  mu25.*par32.*par53+4.*mu15.*mu25.*par32.*par53+(-3).*mu15.*mu23.* ...
  par31.*par32.*par53+(-3).*mu13.*mu25.*par31.*par32.*par53+mu15.* ...
  mu24.*par32.*par41.*par53+(-4).*mu14.*mu25.*par32.*par41.*par53+( ...
  -4).*mu15.*mu24.*par31.*par42.*par53+mu14.*mu25.*par31.*par42.* ...
  par53+(-3).*mu15.*mu24.*par31.*par32.*par43.*par53+(-3).*mu14.* ...
  mu25.*par31.*par32.*par43.*par53+(-3).*mu15.*mu25.*par32.*par51.* ...
  par53+(-3).*mu15.*mu25.*par31.*par52.*par53+(-3).*mu15.*mu25.* ...
  par31.*par32.*par53.^2+mu25.*(mu12.*(par41+4.*par42+par31.*par43+ ...
  4.*par32.*par43)+(par42+par32.*par43).*(8.*mu10+mu14.*(4+(-3).* ...
  par41+(-3).*par31.*par43))+mu13.*((-4).*((-1)+par31).*par42+ ...
  par32.*(par41+4.*par43+(-3).*par31.*par43))).*par54+mu15.*(4.* ...
  mu23.*par41+4.*mu24.*par41+4.*mu25.*par41+(-4).*mu23.*par32.* ...
  par41+4.*mu25.*par42+mu23.*par31.*par42+(-3).*mu24.*par41.*par42+ ...
  4.*mu23.*par31.*par43+4.*mu24.*par31.*par43+4.*mu25.*par31.*par43+ ...
  4.*mu25.*par32.*par43+(-3).*mu23.*par31.*par32.*par43+(-3).*mu24.* ...
  par32.*par41.*par43+(-3).*mu24.*par31.*par42.*par43+(-3).*mu24.* ...
  par31.*par32.*par43.^2+8.*mu20.*(par41+par31.*par43)+mu21.*(4.* ...
  par41+par42+4.*par31.*par43+par32.*par43)+(-3).*mu25.*par42.* ...
  par51+(-3).*mu25.*par32.*par43.*par51+(-3).*mu25.*par41.*par52+( ...
  -3).*mu25.*par31.*par43.*par52+(-3).*mu25.*(par32.*par41+par31.* ...
  par42+2.*par31.*par32.*par43).*par53).*par54+(-3).*mu15.*mu25.*( ...
  par41+par31.*par43).*(par42+par32.*par43).*par54.^2).^(-1).*((-8) ...
  .*c.*mu10.*mu20+(-6).*c.*mu12.*mu20+(-4).*c.*mu13.*mu20+(-4).*c.* ...
  mu14.*mu20+(-4).*c.*mu15.*mu20+(-4).*c.*mu10.*mu21+(-3).*c.*mu12.* ...
  mu21+(-2).*c.*mu13.*mu21+(-2).*c.*mu14.*mu21+(-2).*c.*mu15.*mu21+( ...
  -4).*c.*mu10.*mu23+(-3).*c.*mu12.*mu23+(-2).*c.*mu13.*mu23+(-2).* ...
  c.*mu14.*mu23+(-2).*c.*mu15.*mu23+(-4).*c.*mu10.*mu24+(-3).*c.* ...
  mu12.*mu24+(-2).*c.*mu13.*mu24+(-2).*c.*mu14.*mu24+(-2).*c.*mu15.* ...
  mu24+(-4).*c.*mu10.*mu25+(-3).*c.*mu12.*mu25+(-2).*c.*mu13.*mu25+( ...
  -2).*c.*mu14.*mu25+(-2).*c.*mu15.*mu25+(-4).*mu13.*mu20.*par30+( ...
  -2).*mu13.*mu21.*par30+(-1).*mu12.*mu23.*par30+(-2).*mu13.*mu23.* ...
  par30+(-2).*mu13.*mu24.*par30+(-2).*mu13.*mu25.*par30+4.*c.*mu13.* ...
  mu20.*par31+2.*c.*mu13.*mu21.*par31+2.*c.*mu13.*mu23.*par31+2.*c.* ...
  mu13.*mu24.*par31+2.*c.*mu13.*mu25.*par31+(-2).*c.*mu13.*mu20.* ...
  par32+(-1).*c.*mu13.*mu21.*par32+4.*c.*mu10.*mu23.*par32+3.*c.* ...
  mu12.*mu23.*par32+c.*mu13.*mu23.*par32+2.*c.*mu14.*mu23.*par32+2.* ...
  c.*mu15.*mu23.*par32+(-1).*c.*mu13.*mu24.*par32+(-1).*c.*mu13.* ...
  mu25.*par32+mu13.*mu23.*par30.*par32+(-2).*c.*mu13.*mu23.*par31.* ...
  par32+c.*mu13.*mu23.*par32.^2+(-4).*mu14.*mu20.*par40+(-2).*mu14.* ...
  mu21.*par40+(-2).*mu14.*mu23.*par40+(-1).*mu12.*mu24.*par40+(-2).* ...
  mu14.*mu24.*par40+(-2).*mu14.*mu25.*par40+2.*mu14.*mu23.*par32.* ...
  par40+(-1).*mu13.*mu24.*par32.*par40+4.*c.*mu14.*mu20.*par41+2.* ...
  c.*mu14.*mu21.*par41+2.*c.*mu14.*mu23.*par41+2.*c.*mu14.*mu24.* ...
  par41+2.*c.*mu14.*mu25.*par41+(-2).*c.*mu14.*mu23.*par32.*par41+( ...
  -2).*c.*mu14.*mu20.*par42+(-1).*c.*mu14.*mu21.*par42+(-1).*c.* ...
  mu14.*mu23.*par42+4.*c.*mu10.*mu24.*par42+3.*c.*mu12.*mu24.*par42+ ...
  2.*c.*mu13.*mu24.*par42+c.*mu14.*mu24.*par42+2.*c.*mu15.*mu24.* ...
  par42+(-1).*c.*mu14.*mu25.*par42+(-1).*mu14.*mu23.*par30.*par42+ ...
  2.*mu13.*mu24.*par30.*par42+(-2).*c.*mu13.*mu24.*par31.*par42+c.* ...
  mu14.*mu23.*par32.*par42+c.*mu13.*mu24.*par32.*par42+mu14.*mu24.* ...
  par40.*par42+(-2).*c.*mu14.*mu24.*par41.*par42+c.*mu14.*mu24.* ...
  par42.^2+(-4).*mu14.*mu20.*par30.*par43+(-2).*mu14.*mu21.*par30.* ...
  par43+(-2).*mu14.*mu23.*par30.*par43+(-1).*mu12.*mu24.*par30.* ...
  par43+(-2).*mu14.*mu24.*par30.*par43+(-2).*mu14.*mu25.*par30.* ...
  par43+4.*c.*mu14.*mu20.*par31.*par43+2.*c.*mu14.*mu21.*par31.* ...
  par43+2.*c.*mu14.*mu23.*par31.*par43+2.*c.*mu14.*mu24.*par31.* ...
  par43+2.*c.*mu14.*mu25.*par31.*par43+(-2).*c.*mu14.*mu20.*par32.* ...
  par43+(-1).*c.*mu14.*mu21.*par32.*par43+(-1).*c.*mu14.*mu23.* ...
  par32.*par43+4.*c.*mu10.*mu24.*par32.*par43+3.*c.*mu12.*mu24.* ...
  par32.*par43+2.*c.*mu13.*mu24.*par32.*par43+c.*mu14.*mu24.*par32.* ...
  par43+2.*c.*mu15.*mu24.*par32.*par43+(-1).*c.*mu14.*mu25.*par32.* ...
  par43+mu14.*mu23.*par30.*par32.*par43+mu13.*mu24.*par30.*par32.* ...
  par43+(-2).*c.*mu14.*mu23.*par31.*par32.*par43+(-2).*c.*mu13.* ...
  mu24.*par31.*par32.*par43+c.*mu14.*mu23.*par32.^2.*par43+c.*mu13.* ...
  mu24.*par32.^2.*par43+mu14.*mu24.*par32.*par40.*par43+(-2).*c.* ...
  mu14.*mu24.*par32.*par41.*par43+mu14.*mu24.*par30.*par42.*par43+( ...
  -2).*c.*mu14.*mu24.*par31.*par42.*par43+2.*c.*mu14.*mu24.*par32.* ...
  par42.*par43+mu14.*mu24.*par30.*par32.*par43.^2+(-2).*c.*mu14.* ...
  mu24.*par31.*par32.*par43.^2+c.*mu14.*mu24.*par32.^2.*par43.^2+( ...
  -4).*mu15.*mu20.*par50+(-2).*mu15.*mu21.*par50+(-2).*mu15.*mu23.* ...
  par50+(-2).*mu15.*mu24.*par50+(-1).*mu12.*mu25.*par50+(-2).*mu15.* ...
  mu25.*par50+2.*mu15.*mu23.*par32.*par50+(-1).*mu13.*mu25.*par32.* ...
  par50+2.*mu15.*mu24.*par42.*par50+(-1).*mu14.*mu25.*par42.*par50+ ...
  2.*mu15.*mu24.*par32.*par43.*par50+(-1).*mu14.*mu25.*par32.* ...
  par43.*par50+4.*c.*mu15.*mu20.*par51+2.*c.*mu15.*mu21.*par51+2.* ...
  c.*mu15.*mu23.*par51+2.*c.*mu15.*mu24.*par51+2.*c.*mu15.*mu25.* ...
  par51+(-2).*c.*mu15.*mu23.*par32.*par51+(-2).*c.*mu15.*mu24.* ...
  par42.*par51+(-2).*c.*mu15.*mu24.*par32.*par43.*par51+(-2).*c.* ...
  mu15.*mu20.*par52+(-1).*c.*mu15.*mu21.*par52+(-1).*c.*mu15.*mu23.* ...
  par52+(-1).*c.*mu15.*mu24.*par52+4.*c.*mu10.*mu25.*par52+3.*c.* ...
  mu12.*mu25.*par52+2.*c.*mu13.*mu25.*par52+2.*c.*mu14.*mu25.*par52+ ...
  c.*mu15.*mu25.*par52+(-1).*mu15.*mu23.*par30.*par52+2.*mu13.* ...
  mu25.*par30.*par52+(-2).*c.*mu13.*mu25.*par31.*par52+c.*mu15.* ...
  mu23.*par32.*par52+c.*mu13.*mu25.*par32.*par52+(-1).*mu15.*mu24.* ...
  par40.*par52+2.*mu14.*mu25.*par40.*par52+(-2).*c.*mu14.*mu25.* ...
  par41.*par52+c.*mu15.*mu24.*par42.*par52+c.*mu14.*mu25.*par42.* ...
  par52+(-1).*mu15.*mu24.*par30.*par43.*par52+2.*mu14.*mu25.*par30.* ...
  par43.*par52+(-2).*c.*mu14.*mu25.*par31.*par43.*par52+c.*mu15.* ...
  mu24.*par32.*par43.*par52+c.*mu14.*mu25.*par32.*par43.*par52+ ...
  mu15.*mu25.*par50.*par52+(-2).*c.*mu15.*mu25.*par51.*par52+c.* ...
  mu15.*mu25.*par52.^2+(-4).*mu15.*mu20.*par30.*par53+(-2).*mu15.* ...
  mu21.*par30.*par53+(-2).*mu15.*mu23.*par30.*par53+(-2).*mu15.* ...
  mu24.*par30.*par53+(-1).*mu12.*mu25.*par30.*par53+(-2).*mu15.* ...
  mu25.*par30.*par53+4.*c.*mu15.*mu20.*par31.*par53+2.*c.*mu15.* ...
  mu21.*par31.*par53+2.*c.*mu15.*mu23.*par31.*par53+2.*c.*mu15.* ...
  mu24.*par31.*par53+2.*c.*mu15.*mu25.*par31.*par53+(-2).*c.*mu15.* ...
  mu20.*par32.*par53+(-1).*c.*mu15.*mu21.*par32.*par53+(-1).*c.* ...
  mu15.*mu23.*par32.*par53+(-1).*c.*mu15.*mu24.*par32.*par53+4.*c.* ...
  mu10.*mu25.*par32.*par53+3.*c.*mu12.*mu25.*par32.*par53+2.*c.* ...
  mu13.*mu25.*par32.*par53+2.*c.*mu14.*mu25.*par32.*par53+c.*mu15.* ...
  mu25.*par32.*par53+mu15.*mu23.*par30.*par32.*par53+mu13.*mu25.* ...
  par30.*par32.*par53+(-2).*c.*mu15.*mu23.*par31.*par32.*par53+(-2) ...
  .*c.*mu13.*mu25.*par31.*par32.*par53+c.*mu15.*mu23.*par32.^2.* ...
  par53+c.*mu13.*mu25.*par32.^2.*par53+(-1).*mu15.*mu24.*par32.* ...
  par40.*par53+2.*mu14.*mu25.*par32.*par40.*par53+(-2).*c.*mu14.* ...
  mu25.*par32.*par41.*par53+2.*mu15.*mu24.*par30.*par42.*par53+(-1) ...
  .*mu14.*mu25.*par30.*par42.*par53+(-2).*c.*mu15.*mu24.*par31.* ...
  par42.*par53+c.*mu15.*mu24.*par32.*par42.*par53+c.*mu14.*mu25.* ...
  par32.*par42.*par53+mu15.*mu24.*par30.*par32.*par43.*par53+mu14.* ...
  mu25.*par30.*par32.*par43.*par53+(-2).*c.*mu15.*mu24.*par31.* ...
  par32.*par43.*par53+(-2).*c.*mu14.*mu25.*par31.*par32.*par43.* ...
  par53+c.*mu15.*mu24.*par32.^2.*par43.*par53+c.*mu14.*mu25.* ...
  par32.^2.*par43.*par53+mu15.*mu25.*par32.*par50.*par53+(-2).*c.* ...
  mu15.*mu25.*par32.*par51.*par53+mu15.*mu25.*par30.*par52.*par53+( ...
  -2).*c.*mu15.*mu25.*par31.*par52.*par53+2.*c.*mu15.*mu25.*par32.* ...
  par52.*par53+mu15.*mu25.*par30.*par32.*par53.^2+(-2).*c.*mu15.* ...
  mu25.*par31.*par32.*par53.^2+c.*mu15.*mu25.*par32.^2.*par53.^2+( ...
  -2).*alpha1.*(mu20.*(mu12+mu14.*par42+mu15.*par52+par32.*(mu13+ ...
  mu14.*par43+mu15.*par53))+2.*mu10.*(2.*mu20+mu21+mu23+(-1).*mu23.* ...
  par32+(-1).*mu24.*((-1)+par42+par32.*par43)+(-1).*mu25.*((-1)+ ...
  par52+par32.*par53)))+(-4).*mu15.*mu20.*par40.*par54+(-2).*mu15.* ...
  mu21.*par40.*par54+(-2).*mu15.*mu23.*par40.*par54+(-2).*mu15.* ...
  mu24.*par40.*par54+(-1).*mu12.*mu25.*par40.*par54+(-2).*mu15.* ...
  mu25.*par40.*par54+2.*mu15.*mu23.*par32.*par40.*par54+(-1).*mu13.* ...
  mu25.*par32.*par40.*par54+4.*c.*mu15.*mu20.*par41.*par54+2.*c.* ...
  mu15.*mu21.*par41.*par54+2.*c.*mu15.*mu23.*par41.*par54+2.*c.* ...
  mu15.*mu24.*par41.*par54+2.*c.*mu15.*mu25.*par41.*par54+(-2).*c.* ...
  mu15.*mu23.*par32.*par41.*par54+(-2).*c.*mu15.*mu20.*par42.*par54+ ...
  (-1).*c.*mu15.*mu21.*par42.*par54+(-1).*c.*mu15.*mu23.*par42.* ...
  par54+(-1).*c.*mu15.*mu24.*par42.*par54+4.*c.*mu10.*mu25.*par42.* ...
  par54+3.*c.*mu12.*mu25.*par42.*par54+2.*c.*mu13.*mu25.*par42.* ...
  par54+2.*c.*mu14.*mu25.*par42.*par54+c.*mu15.*mu25.*par42.*par54+( ...
  -1).*mu15.*mu23.*par30.*par42.*par54+2.*mu13.*mu25.*par30.*par42.* ...
  par54+(-2).*c.*mu13.*mu25.*par31.*par42.*par54+c.*mu15.*mu23.* ...
  par32.*par42.*par54+c.*mu13.*mu25.*par32.*par42.*par54+mu15.* ...
  mu24.*par40.*par42.*par54+mu14.*mu25.*par40.*par42.*par54+(-2).* ...
  c.*mu15.*mu24.*par41.*par42.*par54+(-2).*c.*mu14.*mu25.*par41.* ...
  par42.*par54+c.*mu15.*mu24.*par42.^2.*par54+c.*mu14.*mu25.* ...
  par42.^2.*par54+(-4).*mu15.*mu20.*par30.*par43.*par54+(-2).*mu15.* ...
  mu21.*par30.*par43.*par54+(-2).*mu15.*mu23.*par30.*par43.*par54+( ...
  -2).*mu15.*mu24.*par30.*par43.*par54+(-1).*mu12.*mu25.*par30.* ...
  par43.*par54+(-2).*mu15.*mu25.*par30.*par43.*par54+4.*c.*mu15.* ...
  mu20.*par31.*par43.*par54+2.*c.*mu15.*mu21.*par31.*par43.*par54+ ...
  2.*c.*mu15.*mu23.*par31.*par43.*par54+2.*c.*mu15.*mu24.*par31.* ...
  par43.*par54+2.*c.*mu15.*mu25.*par31.*par43.*par54+(-2).*c.*mu15.* ...
  mu20.*par32.*par43.*par54+(-1).*c.*mu15.*mu21.*par32.*par43.* ...
  par54+(-1).*c.*mu15.*mu23.*par32.*par43.*par54+(-1).*c.*mu15.* ...
  mu24.*par32.*par43.*par54+4.*c.*mu10.*mu25.*par32.*par43.*par54+ ...
  3.*c.*mu12.*mu25.*par32.*par43.*par54+2.*c.*mu13.*mu25.*par32.* ...
  par43.*par54+2.*c.*mu14.*mu25.*par32.*par43.*par54+c.*mu15.*mu25.* ...
  par32.*par43.*par54+mu15.*mu23.*par30.*par32.*par43.*par54+mu13.* ...
  mu25.*par30.*par32.*par43.*par54+(-2).*c.*mu15.*mu23.*par31.* ...
  par32.*par43.*par54+(-2).*c.*mu13.*mu25.*par31.*par32.*par43.* ...
  par54+c.*mu15.*mu23.*par32.^2.*par43.*par54+c.*mu13.*mu25.* ...
  par32.^2.*par43.*par54+mu15.*mu24.*par32.*par40.*par43.*par54+ ...
  mu14.*mu25.*par32.*par40.*par43.*par54+(-2).*c.*mu15.*mu24.* ...
  par32.*par41.*par43.*par54+(-2).*c.*mu14.*mu25.*par32.*par41.* ...
  par43.*par54+mu15.*mu24.*par30.*par42.*par43.*par54+mu14.*mu25.* ...
  par30.*par42.*par43.*par54+(-2).*c.*mu15.*mu24.*par31.*par42.* ...
  par43.*par54+(-2).*c.*mu14.*mu25.*par31.*par42.*par43.*par54+2.* ...
  c.*mu15.*mu24.*par32.*par42.*par43.*par54+2.*c.*mu14.*mu25.* ...
  par32.*par42.*par43.*par54+mu15.*mu24.*par30.*par32.*par43.^2.* ...
  par54+mu14.*mu25.*par30.*par32.*par43.^2.*par54+(-2).*c.*mu15.* ...
  mu24.*par31.*par32.*par43.^2.*par54+(-2).*c.*mu14.*mu25.*par31.* ...
  par32.*par43.^2.*par54+c.*mu15.*mu24.*par32.^2.*par43.^2.*par54+ ...
  c.*mu14.*mu25.*par32.^2.*par43.^2.*par54+(-2).*alpha1.*(mu15.*mu20+ ...
  (-2).*mu10.*mu25).*(par42+par32.*par43).*par54+mu15.*mu25.*par42.* ...
  par50.*par54+mu15.*mu25.*par32.*par43.*par50.*par54+(-2).*c.* ...
  mu15.*mu25.*par42.*par51.*par54+(-2).*c.*mu15.*mu25.*par32.* ...
  par43.*par51.*par54+mu15.*mu25.*par40.*par52.*par54+(-2).*c.* ...
  mu15.*mu25.*par41.*par52.*par54+2.*c.*mu15.*mu25.*par42.*par52.* ...
  par54+mu15.*mu25.*par30.*par43.*par52.*par54+(-2).*c.*mu15.*mu25.* ...
  par31.*par43.*par52.*par54+2.*c.*mu15.*mu25.*par32.*par43.*par52.* ...
  par54+mu15.*mu25.*par32.*par40.*par53.*par54+(-2).*c.*mu15.*mu25.* ...
  par32.*par41.*par53.*par54+mu15.*mu25.*par30.*par42.*par53.*par54+ ...
  (-2).*c.*mu15.*mu25.*par31.*par42.*par53.*par54+2.*c.*mu15.*mu25.* ...
  par32.*par42.*par53.*par54+2.*mu15.*mu25.*par30.*par32.*par43.* ...
  par53.*par54+(-4).*c.*mu15.*mu25.*par31.*par32.*par43.*par53.* ...
  par54+2.*c.*mu15.*mu25.*par32.^2.*par43.*par53.*par54+mu15.*mu25.* ...
  par40.*par42.*par54.^2+(-2).*c.*mu15.*mu25.*par41.*par42.* ...
  par54.^2+c.*mu15.*mu25.*par42.^2.*par54.^2+mu15.*mu25.*par32.* ...
  par40.*par43.*par54.^2+(-2).*c.*mu15.*mu25.*par32.*par41.*par43.* ...
  par54.^2+mu15.*mu25.*par30.*par42.*par43.*par54.^2+(-2).*c.*mu15.* ...
  mu25.*par31.*par42.*par43.*par54.^2+2.*c.*mu15.*mu25.*par32.* ...
  par42.*par43.*par54.^2+mu15.*mu25.*par30.*par32.*par43.^2.* ...
  par54.^2+(-2).*c.*mu15.*mu25.*par31.*par32.*par43.^2.*par54.^2+c.* ...
  mu15.*mu25.*par32.^2.*par43.^2.*par54.^2+2.*alpha0.*(mu20.*(mu12+ ...
  mu14.*par42+mu15.*par52+par32.*(mu13+mu14.*par43+mu15.*par53)+ ...
  mu15.*(par42+par32.*par43).*par54)+2.*mu10.*(2.*mu20+mu21+mu23+( ...
  -1).*mu23.*par32+(-1).*mu24.*((-1)+par42+par32.*par43)+(-1).* ...
  mu25.*((-1)+par52+par42.*par54+par32.*(par53+par43.*par54))))+(-1) ...
  .*(4.*mu12.*mu20+4.*mu13.*mu20+4.*mu14.*mu20+4.*mu15.*mu20+3.* ...
  mu12.*mu21+2.*mu13.*mu21+2.*mu14.*mu21+2.*mu15.*mu21+mu12.*mu22+ ...
  3.*mu12.*mu23+2.*mu13.*mu23+2.*mu14.*mu23+2.*mu15.*mu23+3.*mu12.* ...
  mu24+2.*mu13.*mu24+2.*mu14.*mu24+2.*mu15.*mu24+3.*mu12.*mu25+2.* ...
  mu13.*mu25+2.*mu14.*mu25+2.*mu15.*mu25+mu13.*mu21.*par32+mu13.* ...
  mu22.*par32+(-2).*mu12.*mu23.*par32+(-1).*mu13.*mu23.*par32+(-2).* ...
  mu14.*mu23.*par32+(-2).*mu15.*mu23.*par32+mu13.*mu24.*par32+mu13.* ...
  mu25.*par32+mu14.*mu21.*par42+mu14.*mu22.*par42+mu14.*mu23.*par42+ ...
  (-2).*mu12.*mu24.*par42+(-2).*mu13.*mu24.*par42+(-1).*mu14.*mu24.* ...
  par42+(-2).*mu15.*mu24.*par42+mu14.*mu25.*par42+mu14.*mu21.* ...
  par32.*par43+mu14.*mu22.*par32.*par43+mu14.*mu23.*par32.*par43+( ...
  -2).*mu12.*mu24.*par32.*par43+(-2).*mu13.*mu24.*par32.*par43+(-1) ...
  .*mu14.*mu24.*par32.*par43+(-2).*mu15.*mu24.*par32.*par43+mu14.* ...
  mu25.*par32.*par43+mu15.*mu21.*par52+mu15.*mu22.*par52+mu15.* ...
  mu23.*par52+mu15.*mu24.*par52+(-2).*mu12.*mu25.*par52+(-2).*mu13.* ...
  mu25.*par52+(-2).*mu14.*mu25.*par52+(-1).*mu15.*mu25.*par52+mu15.* ...
  mu21.*par32.*par53+mu15.*mu22.*par32.*par53+mu15.*mu23.*par32.* ...
  par53+mu15.*mu24.*par32.*par53+(-2).*mu12.*mu25.*par32.*par53+(-2) ...
  .*mu13.*mu25.*par32.*par53+(-2).*mu14.*mu25.*par32.*par53+(-1).* ...
  mu15.*mu25.*par32.*par53+(mu15.*(mu21+mu22+mu23+mu24+(-1).*mu25)+( ...
  -2).*(mu12+mu13+mu14).*mu25).*(par42+par32.*par43).*par54+2.* ...
  mu11.*(2.*mu20+mu21+mu23+(-1).*mu23.*par32+(-1).*mu24.*((-1)+ ...
  par42+par32.*par43)+(-1).*mu25.*((-1)+par52+par42.*par54+par32.*( ...
  par53+par43.*par54)))).*tau);




pstar(3) = R3(pstar(1),pstar(2));
pstar(4) = R4(pstar(1),pstar(2),pstar(3));
pstar(5) = R5(pstar(1),pstar(2),pstar(3),pstar(4));

% Profit
pi(1) = (pstar(1)-c)*s1(pstar(1),pstar(2),pstar(3),pstar(4),pstar(5));
pi(2) = (pstar(2)-c)*s2(pstar(1),pstar(2),pstar(3),pstar(4),pstar(5));
pi(3) = (pstar(3)-c)*s3(pstar(1),pstar(2),pstar(3),pstar(4),pstar(5));
pi(4) = (pstar(4)-c)*s4(pstar(1),pstar(2),pstar(3),pstar(4),pstar(5));
pi(5) = (pstar(5)-c)*s5(pstar(1),pstar(2),pstar(3),pstar(4),pstar(5));


% share
tot = s1(pstar(1),pstar(2),pstar(3),pstar(4),pstar(5)) + s2(pstar(1),pstar(2),pstar(3),pstar(4),pstar(5)) + s3(pstar(1),pstar(2),pstar(3),pstar(4),pstar(5)) + s4(pstar(1),pstar(2),pstar(3),pstar(4),pstar(5)) + s5(pstar(1),pstar(2),pstar(3),pstar(4),pstar(5));
share(1) = s1(pstar(1),pstar(2),pstar(3),pstar(4),pstar(5)) / tot;
share(2) = s2(pstar(1),pstar(2),pstar(3),pstar(4),pstar(5)) / tot;
share(3) = s3(pstar(1),pstar(2),pstar(3),pstar(4),pstar(5)) / tot;
share(4) = s4(pstar(1),pstar(2),pstar(3),pstar(4),pstar(5)) / tot;
share(5) = s5(pstar(1),pstar(2),pstar(3),pstar(4),pstar(5)) / tot;

% Bertrand nash share
tot_sbn = s1(pstar_sbn(1),pstar_sbn(2),pstar_sbn(3),pstar_sbn(4),pstar_sbn(5)) + s2(pstar_sbn(1),pstar_sbn(2),pstar_sbn(3),pstar_sbn(4),pstar_sbn(5)) + s3(pstar_sbn(1),pstar_sbn(2),pstar_sbn(3),pstar_sbn(4),pstar_sbn(5)) + s4(pstar_sbn(1),pstar_sbn(2),pstar_sbn(3),pstar_sbn(4),pstar_sbn(5)) + s5(pstar_sbn(1),pstar_sbn(2),pstar_sbn(3),pstar_sbn(4),pstar_sbn(5));
share_sbn(1) = s1(pstar_sbn(1),pstar_sbn(2),pstar_sbn(3),pstar_sbn(4),pstar_sbn(5)) / tot_sbn;
share_sbn(2) = s2(pstar_sbn(1),pstar_sbn(2),pstar_sbn(3),pstar_sbn(4),pstar_sbn(5)) / tot_sbn;
share_sbn(3) = s3(pstar_sbn(1),pstar_sbn(2),pstar_sbn(3),pstar_sbn(4),pstar_sbn(5)) / tot_sbn;
share_sbn(4) = s4(pstar_sbn(1),pstar_sbn(2),pstar_sbn(3),pstar_sbn(4),pstar_sbn(5)) / tot_sbn;
share_sbn(5) = s5(pstar_sbn(1),pstar_sbn(2),pstar_sbn(3),pstar_sbn(4),pstar_sbn(5)) / tot_sbn;


% Bertrand nash  Profit
pi_sbn(1) = (pstar_sbn(1)-c)*s1(pstar_sbn(1),pstar_sbn(2),pstar_sbn(3),pstar_sbn(4),pstar_sbn(5));
pi_sbn(2) = (pstar_sbn(2)-c)*s2(pstar_sbn(1),pstar_sbn(2),pstar_sbn(3),pstar_sbn(4),pstar_sbn(5));
pi_sbn(3) = (pstar_sbn(3)-c)*s3(pstar_sbn(1),pstar_sbn(2),pstar_sbn(3),pstar_sbn(4),pstar_sbn(5));
pi_sbn(4) = (pstar_sbn(4)-c)*s4(pstar_sbn(1),pstar_sbn(2),pstar_sbn(3),pstar_sbn(4),pstar_sbn(5));
pi_sbn(5) = (pstar_sbn(5)-c)*s5(pstar_sbn(1),pstar_sbn(2),pstar_sbn(3),pstar_sbn(4),pstar_sbn(5));

% Quantities

quant(1) = s1(pstar(1),pstar(2),pstar(3),pstar(4),pstar(5));
quant(2) = s2(pstar(1),pstar(2),pstar(3),pstar(4),pstar(5));
quant(3) = s3(pstar(1),pstar(2),pstar(3),pstar(4),pstar(5));
quant(4) = s4(pstar(1),pstar(2),pstar(3),pstar(4),pstar(5));
quant(5) = s5(pstar(1),pstar(2),pstar(3),pstar(4),pstar(5));

quant_sbn(1) = s1(pstar_sbn(1),pstar_sbn(2),pstar_sbn(3),pstar_sbn(4),pstar_sbn(5));
quant_sbn(2) = s2(pstar_sbn(1),pstar_sbn(2),pstar_sbn(3),pstar_sbn(4),pstar_sbn(5));
quant_sbn(3) = s3(pstar_sbn(1),pstar_sbn(2),pstar_sbn(3),pstar_sbn(4),pstar_sbn(5));
quant_sbn(4) = s4(pstar_sbn(1),pstar_sbn(2),pstar_sbn(3),pstar_sbn(4),pstar_sbn(5));
quant_sbn(5) = s5(pstar_sbn(1),pstar_sbn(2),pstar_sbn(3),pstar_sbn(4),pstar_sbn(5));

end


% Sub functions




